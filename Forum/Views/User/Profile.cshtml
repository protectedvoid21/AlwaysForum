@using AlwaysForum.Extensions
@model Data.ViewModels.UserProfileViewModel

<style>
    .avatar {
        width: 100%;
        height: 100%;
    }

    .avatar-container {
        width: 100px;
        height: 100px;
        border: 3px solid #bbbbbb;
        border-radius: 5px;
        padding: 1%;
        position: relative;
    }

    .change-profile {
        transition: .5s ease;
        opacity: 0;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        -ms-transform: translate(-50%, -50%);
        text-align: center;
    }

    .avatar-container:hover {
        background-color: #777777;
    }

    .avatar-container:hover .change-profile {
        opacity: 1;
    }

    #change-profile-component {
        position: fixed;
        width: 100%;
        height: 100%;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: rgba(0, 0, 0, 0.5);
        display: none;
        z-index: 2;
    }

    .component-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgb(255, 255, 255);
    }
</style>

<div id="change-profile-component">
    <div class="component-container">
        @await Component.InvokeAsync("ChangeProfilePicture", Model.ProfilePicture)
    </div>
</div>

<div class="d-flex gap-4 m-3">
    <div class="avatar-container">
        <div>
            @if (string.IsNullOrEmpty(Model.ProfilePicture)) {
                <img src="/images/default-picture.svg" class="avatar">
            }
            else {
                <img src="/images/userpictures/@Model.ProfilePicture" class="avatar">
            }
            <div class="change-profile">
                <btn class="btn btn-info">Change avatar</btn>
            </div>
        </div>
    </div>
    <div>
        <h2>@Model.UserName</h2>
        <p>Registered : @Model.CreatedDate</p>
    </div>
</div>
<hr/>
<p>Posts : @Model.PostCount</p>

@section Scripts {
    <script>
        const changeProfilePictureButton = document.querySelector('.change-profile')
        const changeProfileComponent = document.getElementById('change-profile-component')

        changeProfilePictureButton.addEventListener('click', () => {
            if (changeProfileComponent.style.display === 'none') {
                changeProfileComponent.style.display = 'block'
            } 
            else {
                changeProfileComponent.style.display = 'none'
            }
        })
    </script>
}
