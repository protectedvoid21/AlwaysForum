@model int

<div class="d-flex justify-content-around">
    <div>
        <button id="like-button" class="btn btn-success" onclick="react('like')">Like</button>
        <p class="reaction-count">0</p>
    </div>
    <div>
        <button id="love-button" class="btn btn-success" onclick="react('love')">Love</button>
        <p class="reaction-count">0</p>
    </div>
    <div>
        <button id="wow-button" class="btn btn-success" onclick="react('wow')">Wow</button>
        <p class="reaction-count">0</p>
    </div>
    <div>
        <button id="sad-button" class="btn btn-success" onclick="react('sad')">Sad</button>
        <p class="reaction-count">0</p>
    </div>
    <div>
        <button id="angry-button" class="btn btn-success" onclick="react('angry')">Angry</button>
        <p class="reaction-count">0</p>
    </div>
</div>

<script>
    const reactionTexts = document.querySelectorAll('.reaction-count')

    async function getReactions() {
        const response = await fetch('https://localhost:7150/api/reaction/' + @Model)

        const jsonResponse = await response.json()

        for (let i = 0; i < 5; i++) {
            reactionTexts[i].textContent = jsonResponse.filter(r => r.reactionType == i).length
        }
    }

    window.onload = getReactions()

    async function react(reactionType) {
        const url = `https://localhost:7150/api/reaction/${reactionType}/${@Model}`

        await fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        })

        await getReactions()
    }
</script>